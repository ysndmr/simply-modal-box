(function($) {

  $.extend({
    simplyModal: function(pr) {
      var thisSelf = this;
      var options = $.extend({
        title: '',
        description: '',
        setTimeout: false,
        classSet: ['default', 'success', 'info', 'error', 'iframeModal'],
        class: '',
        typeSet: ['default', 'type1', 'notifyTemplate', 'iframeModal'],
        type: '',
        buttonNameSet: ['Yes', 'No'],
        button: '',
        close: true,
        effects: ['fadein', 'slideRight', 'slideBottom', 'fall', 'flid3d', 'scale', 'newspaper', 'd3rotate', 'horizontal-3d'],
        effect: '',
        classBtn : 'simply-iframeModal',
        defaultW : 400,
        defaultH : 500,
        cookie : {
                    expire : null,
                    name : null
                }
      }, pr);
      var params = {
        elm: '.modal-box-group',
        iconClass: '',
        typeIconClass: '',
        iconUrl: 'src/icons/',
        iconWidthHeight: 'width="25" height="25"',
        popup : null
      };


      function ModalHtml() {

        if(options.cookie.name && options.cookie.expire){
            SetCookie();
        }
        if(options.classBtn != null || options.classBtn != undefined || options.classBtn.length >0){
            var iframeData = {
              'url' : $('.'+options.classBtn).attr('data-src'),
              'height' : options.defaultH || $('.'+options.classBtn).attr('data-height') ,
              'width' : options.defaultW || $('.'+options.classBtn).attr('data-width')
            };
        }
        options.class = options.classSet.indexOf(options.class) != -1 ? options.class : 'default';
        options.type = options.typeSet.indexOf(options.type) != -1 ? options.type : 'default';
        options.button = options.button.length > 1 ? options.button : options.buttonNameSet;
        options.effect = options.effects.indexOf(options.effect) != -1 ? options.effect : 'fadein';
        var appendOverlay = $("<div class='modal-overlay " + options.class + " modal-close-group'></div>");
        if (options.type == 'type1') {
          if (options.class == 'success') {
            params.iconClass = '<img src="' + params.iconUrl + '' + options.class + '.svg" ' + params.iconWidthHeight + ' />';
          } else if (options.class == 'error') {
            params.iconClass = '<img src="' + params.iconUrl + '' + options.class + '.svg" ' + params.iconWidthHeight + ' />';
          } else if (options.class == 'info') {
            params.iconClass = '<img src="' + params.iconUrl + '' + options.class + '.svg" ' + params.iconWidthHeight + ' />'
          }
             else if  (options.class == 'default') {
            params.iconClass = ''
          }

        } else {
          if (options.class == 'success') {
            params.iconClass = '<img src="' + params.iconUrl + '' + options.class + '-white.svg" ' + params.iconWidthHeight + ' />';
          } else if (options.class == 'error') {
            params.iconClass = '<img src="' + params.iconUrl + '' + options.class + '-white.svg" ' + params.iconWidthHeight + ' />';
          } else if (options.class == 'info') {
            params.iconClass = '<img src="' + params.iconUrl + '' + options.class + '-white.svg" ' + params.iconWidthHeight + ' />'
          }
          else if  (options.class == 'default') {
            params.iconClass = ''
          }

        }
        var template = $('<div id="popup" class="modal-box-group ' + options.class + ' ' + options.effect + '"><div class="header"><a href="#" class="active modal-close close"><img src="' + params.iconUrl + 'close.svg" '+ params.iconWidthHeight + ' /></a>' + params.iconClass + '</div><div class="modal-body"><h3>' + options.title + '</h3><p>' + options.description + '</p></div></div>');
        var template2 = $('<div id="popup" class="modal-box-group ' + options.type + ' ' + options.class + ' ' + options.effect + '"><div class="header"><a href="#" class=" active modal-close close"><img src="' + params.iconUrl + 'close.svg" '+ params.iconWidthHeight + ' /></a>' + params.iconClass + '</div><div class="modal-body"><h3>' + options.title + '</h3><p>' + options.description + '</p></div><div class="button-group-set"><a href="javascript:void()" class="btn btn-first">' + options.button[0] + '</a><a href="javascript:void()" class="btn btn-second">' + options.button[1] + '</a></div></div>');
        var notifyTemplate = $('<div id="popup" class="modal-box-group notify-group ' + options.class + ' ' + options.effect + '"><div class="alert"><a href="#" class="modal-close close"><img src="' + params.iconUrl + 'close.svg" '+ params.iconWidthHeight + ' /></a> <div class="modal-body">' + params.iconClass + ' <p>' + options.description + '</p></div></div>');
        var iframeTemplate = $('<div id="popup" class="modal-box-group notify-group ' + options.class + ' ' + options.effect + '"><div class="alert"><a href="#" class="modal-close close"><img src="' + params.iconUrl + 'close.svg" '+ params.iconWidthHeight + ' /></a> <div class="modal-body"></h3><iframe style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px" width="100%" height="100%" src="'+iframeData.url+'" frameborder=0 allowfullscreen></iframe></p></div></div>');



        if ($('#popup').length > 0 && $('.modal-overlay').length > 0) {
          $('#popup').remove();
          appendOverlay.remove();
        } else {
          $('body').append(appendOverlay);

          if (options.type == 'type1') {
            debugger
            $(template2).appendTo('body');
          } else if (options.type == 'notifyTemplate') {
            $(notifyTemplate).appendTo('body');
          } else if (options.type == 'iframeModal'){
              $(iframeTemplate).appendTo('body');
              $('#popup').css({
                width : iframeData.width,
                height : iframeData.height
              });

          }
          else {
            $(template).appendTo('body');
          }
        }
         if(options.close){
          ModalCloseEsc($('#popup'));
         }

        ModalClose($('#popup'));
        closeOverlay($('#popup'));
        buttonClose($('#popup'));
        setTimesout($('#popup'));
      };
      function ModalCloseEsc(elm){
        $(document).keyup(function(e) {
          if (e.keyCode === 27){
              modalBoxClose(elm);
          }
        })
      }
      function ModalClose(elm) {
        $('.modal-close').on('click', function(e) {
          e.preventDefault();
          modalBoxClose(elm);
        })
      };
      function setCookie(cname, cvalue, exdays) {
          var d = new Date();
          d.setTime(d.getTime() + (exdays*24*60*60*1000));
          var expires = "expires="+ d.toUTCString();
          document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
      };
      function SetCookie(){
         setCookie(options.cookie.name, 1, options.cookie.expire);
      };
      function resizeModal() {
        $(window).resize(function() {
          if ($(".modal-box-group").hasClass('notify-group')) {
            $(".modal-box-group").css({
              left: ($(window).width() - $(".modal-box-group").outerWidth()) / 2,
            });
          } else {
            $(".modal-box-group").css({
              top: $(window).scrollTop() + ($(window).height() - $(".modal-box-group").outerHeight()) / 2,
              left: ($(window).width() - $(".modal-box-group").outerWidth()) / 2
            });
          }
        });
        $(window).resize();
      };

      function closeOverlay(elm) {

        $(".modal-close-group, .modal-overlay").on('click', function() {
          $(elm).remove();
               $('#popup').remove();
          $('.modal-overlay').remove();
        });
      };

      function buttonClose(elm) {
        $('.button-group-set a').on('click', function(e) {
          e.preventDefault();
          modalBoxClose(elm)
        });
      };

      function modalBoxClose(elm) {

        $(elm).remove();
        $('#popup').remove();
        $('.modal-overlay').remove();
      };

      function setTimesout(elm) {

        if (options.setTimeout != false) {
          setTimeout(function() {
            modalBoxClose(elm);
          }, options.setTimeout);
        }
      };
      ModalHtml();
      ModalClose();
      closeOverlay();
      resizeModal();
      setTimesout();
      $(params.elm).addClass('show');
    }
  });

})(jQuery);